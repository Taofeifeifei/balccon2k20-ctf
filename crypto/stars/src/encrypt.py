#!/usr/bin/env python3

from Crypto.Util.number import bytes_to_long, inverse, long_to_bytes

from flag import FLAG


def encrypt(msg, n, e):
    enc = pow(bytes_to_long(msg), e, n)
    return enc


def decrypt(c, primes, e):
    phi = 1
    for p in primes:
        phi *= (p - 1)

    d = inverse(e, phi)

    return long_to_bytes(pow(c, d, n))


e = 0x10001

primes = [167533300461490643502175542690606039880010565793891341481647599702583605981783968373384116516212904180262848211527133337309639354470515390740639836508230801129939769176016790507088783846910538738863397184991857331933809783653698000636376872349805732385709344877593838293220549121413499191156888187574349083257, 167533300461490643502175542690606039880010565793891341481647599702583605981783968373384116516212904180262848211527133337309639354470515390740639836508230801129939769176016790507088783846910538738863397184991857331933809783653698000636376872349805732385709344877593838293220549121413499191156888187574349083371, 167533300461490643502175542690606039880010565793891341481647599702583605981783968373384116516212904180262848211527133337309639354470515390740639836508230801129939769176016790507088783846910538738863397184991857331933809783653698000636376872349805732385709344877593838293220549121413499191156888187574349083383, 167533300461490643502175542690606039880010565793891341481647599702583605981783968373384116516212904180262848211527133337309639354470515390740639836508230801129939769176016790507088783846910538738863397184991857331933809783653698000636376872349805732385709344877593838293220549121413499191156888187574349083547, 167533300461490643502175542690606039880010565793891341481647599702583605981783968373384116516212904180262848211527133337309639354470515390740639836508230801129939769176016790507088783846910538738863397184991857331933809783653698000636376872349805732385709344877593838293220549121413499191156888187574349083571, 167533300461490643502175542690606039880010565793891341481647599702583605981783968373384116516212904180262848211527133337309639354470515390740639836508230801129939769176016790507088783846910538738863397184991857331933809783653698000636376872349805732385709344877593838293220549121413499191156888187574349083599, 167533300461490643502175542690606039880010565793891341481647599702583605981783968373384116516212904180262848211527133337309639354470515390740639836508230801129939769176016790507088783846910538738863397184991857331933809783653698000636376872349805732385709344877593838293220549121413499191156888187574349083613]

n = 1
for p in primes:
    n *= p


c = encrypt(FLAG, n, e)

m = decrypt(c, primes, e)
assert m == FLAG

print('n =', n)
print('e =', e)
print('c =', c)
